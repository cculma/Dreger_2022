load("~/Documents/git/big_files/tidy_Dreger1.RData")
head(ST1.1)
View(ST1.1)
load("/home/hawkins/Documents/git/big_files/tidy_Dreger1.RData")
library(asreml)
library(asremlPlus)
library(tidyverse)
library(ggcorrplot)
library(patchwork)
library(Matrix)
library(asreml)
FD2 <- read.csv("~/Documents/git/Dreger_2022/raw_data/FD_raw1.csv")
FD2 <- inner_join(b1, FD2, by = "ID") %>% select(5,9,10) %>% distinct(gen, .keep_all = T)
FD2[,colnames(FD2)] <- lapply(FD2[,colnames(FD2)], factor)
# join with ST1.1: BLUP values of quality traits
FD3 <- ST1.1 %>% inner_join(., FD2, by = "gen") %>% separate(3, c("loc", "year", "cut"), sep = "_", remove = F, convert = FALSE, extra = "merge")
head(FD3)
FD4 <- FD3 %>% dplyr::filter(loc == "OR") %>% dplyr::filter(trait == "ADF")
View(FD4)
head(FD4)
FD4$FD <- as.numeric(FD4$FD)
mod1 <- lm(predicted.value ~ FD + year + FD:year, data = FD4)
anova(mod1)
head(FD4)
mod1 <- lm(predicted.value ~ FD + year + cut + FD:year, data = FD4)
anova(mod1)
FD4 <- FD3 %>% dplyr::filter(trait == "ADF")
head(FD4)
mod1 <- lm(predicted.value ~ FD + year + cut + loc, data = FD4)
anova(mod1)
head(FD4)
mod1 <- lm(predicted.value ~ FD + year + cut + loc + env, data = FD4)
anova(mod1)
mod1 <- lm(predicted.value ~ FD + year + cut + loc + year:cut, data = FD4)
anova(mod1)
length(ST01)
names(ST01)
FD4 <- FD3 %>% dplyr::filter(trait == "Starch")
FD4$FD <- as.numeric(FD4$FD)
mod1 <- lm(predicted.value ~ FD + year + cut + loc + year:cut, data = FD4)
anova(mod1)
FD4 <- FD3 %>% dplyr::filter(trait == "ADF")
FD4$FD <- as.numeric(FD4$FD)
mod1 <- lm(predicted.value ~ FD + year + cut + loc + year:cut, data = FD4)
anova(mod1)
FD4 <- FD3 %>% dplyr::filter(trait == "ADF")
mod1 <- lm(predicted.value ~ FD + year + cut + loc + year:cut, data = FD4)
anova(mod1)
FD4 <- FD3 %>% dplyr::filter(trait == "Su_WSC")
mod1 <- lm(predicted.value ~ FD + year + cut + loc + year:cut, data = FD4)
anova(mod1)
mod2 <- lm(predicted.value ~ year + cut + loc + year:cut, data = FD4)
anova(mod2)
FD4 <- FD3 %>% dplyr::filter(trait == "Su_ESC")
mod1 <- lm(predicted.value ~ FD + year + cut + loc + year:cut, data = FD4)
anova(mod1)
mod1 <- lm(predicted.value ~ FD + year + cut + loc + year:cut, data = FD4)
anova(mod1)
FD4 <- FD3 %>% dplyr::filter(trait == "ADF")
mod1 <- lm(predicted.value ~ FD + year + cut + loc + year:cut, data = FD4)
anova(mod1)
mod1 <- lm(predicted.value ~ FD + year + cut + loc + loc:cut, data = FD4)
anova(mod1)
FD4 <- FD3 %>% dplyr::filter(trait == "ADF")
mod1 <- lm(predicted.value ~ FD + year + cut + loc + loc:cut, data = FD4)
anova(mod1)
FD4 <- FD3 %>% dplyr::filter(trait == "Starch")
mod1 <- lm(predicted.value ~ FD + year + cut + loc + loc:cut, data = FD4)
anova(mod1)
library(metan)
desc_stat(data_ge2)
head(data_ge2)
head(FD4)
FD5 <- FD3 %>% select(1,2,4,6,7) %>% spread(key = trait, value = predicted.value)
FD5 <- FD3 %>% dplyr::filter(trait == "ADF") %>% select(2,3,7) %>% spread(key = key, value = predicted.value)
head(FD4)
FD5 <- FD3 %>% dplyr::filter(trait == "ADF") %>% select(2,3,7) %>% spread(key = env, value = predicted.value)
View(FD5)
FD5 <- FD3 %>% dplyr::filter(trait == "ADF")
View(FD5)
?desc_stat
desc_stat(.data = FD5, stats = "main", hist = F)
?desc_wider
head(FD4)
desc_stat(.data = FD5, stats = "main", hist = F, by = "gen")
desc_stat(.data = FD3, stats = "main", hist = F, by = "trait")
desc_stat(.data = FD3, stats = "main", hist = F, by = "trait")
desc_stat(.data = FD5, stats = "main", hist = F)
FD3 %>% dplyr::filter(trait == "ADF") %>% desc_stat(.data = FD5, stats = "main", hist = F)
FD3 %>% dplyr::filter(trait == "ADF") %>% desc_stat(.data = FD3, stats = "main", hist = F)
FD5 <- FD3 %>% dplyr::filter(trait == "ADF")
desc_stat(.data = FD5, stats = "main", hist = F)
head(FD4)
head(FD3)
FD4 <- split(FD3[,-1], FD3$trait)
names(FD4)
1:length(FD4)
FD5 <- list()
for (i in 1:length(FD4)) {
stat1 <- desc_stat(.data = FD4[[1]], stats = "main", hist = F)
FD5[[length(FD5)+1]] <- stat1
}
names(FD5) <- names(FD4)
FD5 <-rbindlist(FD5, use.names=TRUE, fill=TRUE, idcol="trait")
library(data.table)
FD5 <-rbindlist(FD5, use.names=TRUE, fill=TRUE, idcol="trait")
View(FD5)
FD5 <- list()
for (i in 1:length(FD4)) {
stat1 <- desc_stat(.data = FD4[[i]], stats = "main", hist = F)
FD5[[length(FD5)+1]] <- stat1
}
names(FD5) <- names(FD4)
FD5 <-rbindlist(FD5, use.names=TRUE, fill=TRUE, idcol="trait")
View(FD5)
FD5 <- FD5[,-2]
write.csv(FD5, "~/Documents/git/Dreger_2022/stats_1/desc_stats.csv", quote = F, row.names = F)
head(FD4[[1]])
mod1 <- lm(predicted.value ~ FD + year + cut + loc + loc:cut, data = FD4[[1]])
anova(mod1)[,c(1,3,5)]
final <- anova(mod1)[,c(1,3,5)]
rnames <- rownames(final)
rnames
colnames(final) = c("DF", "MS", "P-value")
View(final)
names(FD4[[1]]
)
names(FD4[1])
colnames(final)[2] = names(FD4[1])
final
final <- as.data.frame(round(final, digits = 2))
final
final$sign[final$`P-value` < 0.05] <- "*"
final$sign[final$`P-value` < 0.01] <- "**"
final$sign[final$`P-value` > 0.05] <- "ns
desc_stat(data_ge2)
head(data_ge2)
FD5 <- FD3 %>% dplyr::filter(trait == "ADF") %>% select(2,3,7) %>% spread(key = env, value = predicted.value)
final$sign[final$`P-value` > 0.05] <- "ns"
final
final[[2]] = paste(final[[2]], ifelse(is.na(final[[4]]), "", final[[4]]))
final
head(FD4[[1]])
mod1 <- lm(predicted.value ~ FD + year + cut + loc + loc:cut, data = FD4[[1]])
final <- anova(mod1)[,c(1,3,5)]
rnames <- rownames(final)
colnames(final) <- c("DF", "MS", "P-value")
colnames(final)[2] <- names(FD4[1])
final <- as.data.frame(round(final, digits = 2))
final
final$sign[final$`P-value` < 0.05] <- "*"
final$sign[final$`P-value` < 0.01] <- "**"
final$sign[final$`P-value` > 0.05] <- "ns"
final
final[[2]] = paste(final[[2]], ifelse(is.na(final[[4]]), "", final[[4]]))
final = final[-c(3,4)]
final
1:length(FD4)
FD6 <- list()
mod1 <- lm(predicted.value ~ FD + year + cut + loc + loc:cut, data = FD4[[1]])
final <- anova(mod1)[,c(1,3,5)]
rnames <- rownames(final)
final
final <- final %>% rownames_to_column(var = "SOV")
final
final
FD6 <- list()
for (i in 1:length(FD4)) {
mod1 <- lm(predicted.value ~ FD + year + cut + loc + loc:cut, data = FD4[[i]])
final <- anova(mod1)[,c(1,3,5)]
rnames <- rownames(final)
colnames(final) <- c("DF", "MS", "P-value")
colnames(final)[2] <- names(FD4[i])
final <- as.data.frame(round(final, digits = 2))
final$sign[final$`P-value` < 0.05] <- "*"
final$sign[final$`P-value` < 0.01] <- "**"
final$sign[final$`P-value` > 0.05] <- "ns"
final[[2]] <- paste(final[[2]], ifelse(is.na(final[[4]]), "", final[[4]]))
final <- final[-c(3,4)]
final <- final %>% rownames_to_column(var = "SOV")
FD6[[length(FD6)+1]] <- final
}
names(FD6) <- names(FD4)
View(FD6)
View(FD6[["ADF"]])
View(FD6[["Cprot"]])
FD6 <- list()
for (i in 1:length(FD4)) {
mod1 <- lm(predicted.value ~ FD + year + cut + loc + loc:cut, data = FD4[[i]])
final <- anova(mod1)[,c(1,3,5)]
rnames <- rownames(final)
colnames(final) <- c("DF", "MS", "P-value")
# colnames(final)[2] <- names(FD4[i])
final <- as.data.frame(round(final, digits = 2))
final$sign[final$`P-value` < 0.05] <- "*"
final$sign[final$`P-value` < 0.01] <- "**"
final$sign[final$`P-value` > 0.05] <- "ns"
final[[2]] <- paste(final[[2]], ifelse(is.na(final[[4]]), "", final[[4]]))
final <- final[-c(3,4)]
final <- final %>% rownames_to_column(var = "SOV")
FD6[[length(FD6)+1]] <- final
}
names(FD6) <- names(FD4)
View(FD6)
View(FD6[["Ash"]])
View(FD6[["Starch"]])
names(FD6)
View(FD6[["IVTDMD30"]])
FD6.1 <- rbindlist(FD6, use.names=TRUE, fill=TRUE, idcol="trait")
View(FD6.1)
FD6.1 <- FD6.1 %>% select(-3) %>% spread(key = trait, value = MS)
View(FD6.1)
head(FD6[[1]])
FD6.2 <- FD6[[1]][1:2]
View(FD6.2)
FD6.2 <- inner_join(FD6.2, FD6.1, by = "SOV")
View(FD6.2)
mod1 <- lm(predicted.value ~ FD + year + cut + loc + loc:cut, data = FD4[[1]])
final <- anova(mod1)[,c(1,3,5)]
final
FD6 <- list()
for (i in 1:length(FD4)) {
mod1 <- lm(predicted.value ~ FD + year + cut + loc + loc:cut, data = FD4[[1]])
final <- anova(mod1)[,c(1,3,5)]
rnames <- rownames(final)
colnames(final) <- c("DF", "MS", "P-value")
# colnames(final)[2] <- names(FD4[i])
final <- as.data.frame(round(final, digits = 2))
final$sign[final$`P-value` < 0.05] <- "*"
final$sign[final$`P-value` < 0.01] <- "**"
final$sign[final$`P-value` < 0.001] <- "***"
final$sign[final$`P-value` > 0.05] <- "ns"
final[[2]] <- paste(final[[2]], ifelse(is.na(final[[4]]), "", final[[4]]))
final <- final[-c(3,4)]
final <- final %>% rownames_to_column(var = "SOV")
FD6[[length(FD6)+1]] <- final
}
names(FD6) <- names(FD4)
FD6.1 <- rbindlist(FD6, use.names=TRUE, fill=TRUE, idcol="trait")
FD6.1 <- FD6.1 %>% select(-3) %>% spread(key = trait, value = MS)
FD6.2 <- FD6[[1]][1:2]
FD6.2 <- inner_join(FD6.2, FD6.1, by = "SOV")
View(FD6.2)
FD6 <- list()
for (i in 1:length(FD4)) {
mod1 <- lm(predicted.value ~ FD + year + cut + loc + loc:cut, data = FD4[[i]])
final <- anova(mod1)[,c(1,3,5)]
rnames <- rownames(final)
colnames(final) <- c("DF", "MS", "P-value")
# colnames(final)[2] <- names(FD4[i])
final <- as.data.frame(round(final, digits = 2))
final$sign[final$`P-value` < 0.05] <- "*"
final$sign[final$`P-value` < 0.01] <- "**"
final$sign[final$`P-value` < 0.001] <- "***"
final$sign[final$`P-value` > 0.05] <- "ns"
final[[2]] <- paste(final[[2]], ifelse(is.na(final[[4]]), "", final[[4]]))
final <- final[-c(3,4)]
final <- final %>% rownames_to_column(var = "SOV")
FD6[[length(FD6)+1]] <- final
}
names(FD6) <- names(FD4)
FD6.1 <- rbindlist(FD6, use.names=TRUE, fill=TRUE, idcol="trait")
FD6.1 <- FD6.1 %>% select(-3) %>% spread(key = trait, value = MS)
head(FD6[[1]])
FD6.2 <- FD6[[1]][1:2]
FD6.2 <- inner_join(FD6.2, FD6.1, by = "SOV")
names(FD6)
FD6.3 <- FD6[[10]][1:2]
View(FD6.3)
FD6.4 <- FD6[[16]][1:2]
View(FD6.4)
FD6.5 <- inner_join(FD6.2, FD6.1, by = "SOV")
View(FD6.5)
FD6.2 <- FD6[[1]][1:2]
FD6.3 <- FD6[[10]][1:2]
FD6.4 <- FD6[[16]][1:2]
FD6.5 <- inner_join(FD6.2, FD6.1, by = "SOV")
View(FD6.5)
write.csv(FD6.5, "~/Documents/git/Dreger_2022/stats_1/AOV.csv", quote = F, row.names = F)
View(FD6.4)
names(FD6)
