anova(mod2)
mod2 <- lmer(predicted.value ~ FD * gen * loc + (1|year) + (1|cut) + (1|loc:year:cut), data = data1)
anova(mod2)
mod2 <- lmer(predicted.value ~ FD * gen * loc + (1|year) + (1|cut)  + (1|year:cut) + (1|loc:year) + (1|FD:cut) + (1|loc:year:cut) + (1|FD:loc:cut), data = data1)
anova(mod2)
mod2 <- lmer(predicted.value ~ FD * gen * loc + (1|year) + (1|cut)  + (1|year:cut) + (1|loc:year) + (1|FD:cut) + (1|loc:year:cut) + (1|FD:loc:cut) + + (1|gen:loc:cut), data = data1)
anova(mod2)
mod2 <- lmer(predicted.value ~ FD * gen * loc + (1|year) + (1|cut)  + (1|year:cut) + (1|loc:year) + (1|FD:cut) + (1|gen:cut) + (1|loc:year:cut) + (1|FD:loc:cut) + (1|gen:loc:cut), data = data1)
anova(mod2)
mod3 <- lmer(predicted.value ~ FD * gen * loc * (1|year) * (1|cut), data = data1)
anova(mod3)
mod2 <- lmer(predicted.value ~ FD * gen * loc + (1|year) + (1|cut)  + (1|year:cut) + (1|loc:year) + (1|FD:cut) + (1|gen:cut) + (1|loc:year:cut) + (1|FD:loc:cut) + (1|gen:loc:cut), data = data1)
# ANOVA lmer
FD6 <- list()
names(FD4)
# ANOVA lmer
FD6 <- list()
for (i in 1:length(FD4)) {
# mod1 <- lmer(predicted.value ~ gen * loc *year + (1|cut) + (1|loc:year:cut), data = FD4[[i]])
mod1 <- lmer(predicted.value ~ FD * gen * loc + (1|year) + (1|cut)  + (1|year:cut) + (1|loc:year) + (1|FD:cut) + (1|gen:cut) + (1|loc:year:cut) + (1|FD:loc:cut) + (1|gen:loc:cut), data = FD4[[i]])
final <- anova(mod1)[,c(1,3,6)]
rnames <- rownames(final)
colnames(final) <- c("MS", "DF", "P-value")
# colnames(final)[2] <- names(FD4[i])
final <- as.data.frame(round(final, digits = 2))
final$sign[final$`P-value` < 0.1] <- "."
final$sign[final$`P-value` < 0.05] <- "*"
final$sign[final$`P-value` < 0.01] <- "**"
final$sign[final$`P-value` < 0.001] <- "***"
final$sign[final$`P-value` > 0.1] <- "ns"
final[[1]] <- paste(final[[1]], ifelse(is.na(final[[4]]), "", final[[4]]))
final <- final[-c(3,4)]
final <- final %>% rownames_to_column(var = "SOV")
FD6[[length(FD6)+1]] <- final
}
names(FD6) <- names(FD4)
View(FD6)
View(FD6[["ADF"]])
mod2 <- lmer(predicted.value ~ FD + gen + loc + FD:loc + gen:loc + (1|year) + (1|cut)  + (1|year:cut) + (1|loc:year) + (1|FD:cut) + (1|gen:cut) + (1|FD:loc:year:cut) + (1|gen:loc:year:cut), data = data1)
mod2 <- lmer(predicted.value ~ FD + gen + loc + FD:loc + gen:loc + (1|year) + (1|cut)  + (1|year:cut) + (1|loc:year) + (1|FD:cut) + (1|gen:cut) + (1|FD:loc:year:cut), data = data1)
# ANOVA lmer
FD6 <- list()
for (i in 1:length(FD4)) {
# mod1 <- lmer(predicted.value ~ gen * loc *year + (1|cut) + (1|loc:year:cut), data = FD4[[i]])
mod1 <- lmer(predicted.value ~ FD + gen + loc + FD:loc + gen:loc + (1|year) + (1|cut)  + (1|year:cut) + (1|loc:year) + (1|FD:cut) + (1|gen:cut) + (1|FD:loc:year:cut), data = FD4[[i]])
final <- anova(mod1)[,c(1,3,6)]
rnames <- rownames(final)
colnames(final) <- c("MS", "DF", "P-value")
# colnames(final)[2] <- names(FD4[i])
final <- as.data.frame(round(final, digits = 2))
final$sign[final$`P-value` < 0.1] <- "."
final$sign[final$`P-value` < 0.05] <- "*"
final$sign[final$`P-value` < 0.01] <- "**"
final$sign[final$`P-value` < 0.001] <- "***"
final$sign[final$`P-value` > 0.1] <- "ns"
final[[1]] <- paste(final[[1]], ifelse(is.na(final[[4]]), "", final[[4]]))
final <- final[-c(3,4)]
final <- final %>% rownames_to_column(var = "SOV")
FD6[[length(FD6)+1]] <- final
}
names(FD6) <- names(FD4)
View(FD6)
View(FD6[["ADF"]])
View(FD6[["DM"]])
FD6.1 <- rbindlist(FD6, use.names=TRUE, fill=TRUE, idcol="trait")
FD6.3 <- FD6.1 %>% select(-4) %>% spread(key = trait, value = MS)
FD6.2 <- FD6[[1]][c(1,3)]
FD6.5 <- inner_join(FD6.2, FD6.3, by = "SOV")
View(FD6.5)
write.csv(FD6.5, "~/Documents/git/Dreger_2022/stats_1/AOV.1.csv", quote = F, row.names = F)
mod1 <- lmer(predicted.value ~ gen * loc *year + (1|cut) + (1|loc:year:cut), data = data1) ##
mod2 <- lmer(predicted.value ~ FD + gen + loc + FD:loc + gen:loc + (1|year) + (1|cut)  + (1|year:cut) + (1|loc:year) + (1|FD:cut) + (1|gen:cut) + (1|FD:loc:year:cut), data = data1)
mod3 <- lmer(predicted.value ~ FD + gen + loc + FD:loc + gen:loc+ (1|year) + (1|cut), data = data1)
anova(mod1, mod2,mod3)
mod3 <- lmer(predicted.value ~ FD + gen + loc + FD:loc + gen:loc
+ (1|year) + (1|cut)  + (1|year:cut)
+ (1|FD:year)  + (1|gen:year) + (1|loc:year)
+ (1|FD:cut) + (1|gen:cut) + (1|loc:cut)
+ (1|FD:loc:year) + (1|gen:loc:year), data = data1)
anova(mod1,mod2,mod3)
mod3 <- lmer(predicted.value ~ FD + gen + loc + FD:loc + gen:loc
+ (1|year) + (1|cut)  + (1|year:cut)
+ (1|FD:year) + (1|gen:year) + (1|loc:year)
+ (1|FD:cut) + (1|gen:cut) + (1|loc:cut)
+ (1|FD:loc:year) + (1|gen:loc:year), data = data1)
# ANOVA lmer
FD6 <- list()
for (i in 1:length(FD4)) {
# mod1 <- lmer(predicted.value ~ gen * loc *year + (1|cut) + (1|loc:year:cut), data = FD4[[i]])
mod1 <- lmer(predicted.value ~ FD + gen + loc + FD:loc + gen:loc
+ (1|year) + (1|cut)  + (1|year:cut)
+ (1|FD:year) + (1|gen:year) + (1|loc:year)
+ (1|FD:cut) + (1|gen:cut) + (1|loc:cut)
+ (1|FD:loc:year) + (1|gen:loc:year), data = FD4[[i]])
final <- anova(mod1)[,c(1,3,6)]
rnames <- rownames(final)
colnames(final) <- c("MS", "DF", "P-value")
# colnames(final)[2] <- names(FD4[i])
final <- as.data.frame(round(final, digits = 2))
final$sign[final$`P-value` < 0.1] <- "."
final$sign[final$`P-value` < 0.05] <- "*"
final$sign[final$`P-value` < 0.01] <- "**"
final$sign[final$`P-value` < 0.001] <- "***"
final$sign[final$`P-value` > 0.1] <- "ns"
final[[1]] <- paste(final[[1]], ifelse(is.na(final[[4]]), "", final[[4]]))
final <- final[-c(3,4)]
final <- final %>% rownames_to_column(var = "SOV")
FD6[[length(FD6)+1]] <- final
}
names(FD6) <- names(FD4)
FD6.1 <- rbindlist(FD6, use.names=TRUE, fill=TRUE, idcol="trait")
FD6.3 <- FD6.1 %>% select(-4) %>% spread(key = trait, value = MS)
FD6.2 <- FD6[[1]][c(1,3)]
FD6.5 <- inner_join(FD6.2, FD6.3, by = "SOV")
View(FD6.5)
mod4 <- lmer(predicted.value ~ FD + gen + loc + FD:loc + gen:loc + (1|year) + (1|cut)  + (1|loc/year/cut) + (1|FD:loc/year/cut) + (1|gen:loc/year/cut), data = data1)
mod4 <- lmer(predicted.value ~ FD + gen + loc + FD:loc + gen:loc + (1|year) + (1|cut)  + (1|loc/year/cut) + (1|FD:(loc/year/cut)) + (1|gen:(loc/year/cut)), data = data1)
mod4 <- lmer(predicted.value ~ FD + gen + loc + FD:loc + gen:loc + (1|year) + (1|cut)  + (1|loc/year/cut) + (1|FD/loc/year/cut) + (1|gen/loc/year/cut), data = data1)
mod4 <- lmer(predicted.value ~ FD + gen + loc + FD:loc + gen:loc + (1|year) + (1|cut)  + (1|loc/year/cut) + (1|FD:loc:year) + (1|gen:loc:year), data = data1)
mod2 <- lmer(predicted.value ~ FD + gen + loc + FD:loc + gen:loc + (1|year) + (1|cut)  + (1|year:cut) + (1|loc:year) + (1|FD:cut) + (1|gen:cut) + (1|FD:loc:year:cut), data = data1)
mod5 <- lmer(predicted.value ~ FD + gen + loc + FD:loc + gen:loc + year + cut, data = data1)
mod5 <- lmer(predicted.value ~ FD + gen + loc + FD:loc + gen:loc + year + + (1|cut), data = data1)
anova(mod5)
mod6 <- lm.fit(predicted.value ~ FD + gen + loc + FD:loc + gen:loc + year + cut, data = data1)
mod6 <- lm(predicted.value ~ FD + gen + loc + FD:loc + gen:loc + year + cut, data = data1)
anova(mod6)
mod1 <- lmer(predicted.value ~ gen * loc *year + (1|cut) + (1|loc:year:cut), data = data1)
anova(mod1)
mod1 <- lmer(predicted.value ~ FD * gen * loc *year + (1|cut) + (1|loc:year:cut), data = data1) ##
anova(mod1)
mod1 <- lmer(predicted.value ~ FD * loc *year + (1|cut) + (1|loc:year:cut), data = data1) ##
anova(mod1)
mod6 <- lm(predicted.value ~ FD + gen + loc + FD:loc + gen:loc + year + cut, data = data1)
anova(mod6)
anova(mod1,mod2,mod3)
mod3 <- lmer(predicted.value ~ FD + loc + FD:loc +
+ (1|year) + (1|cut)  + (1|year:cut)
+ (1|FD:year) + (1|loc:year) + (1|FD:loc)
+ (1|FD:cut) + (1|loc:cut)
+ (1|FD:loc:year) + (1|FD:loc:cut) + (1|loc:year:cut)
+ (1|FD:loc:year:cut), data = data1)
anova(mod3)
mod3 <- lmer(predicted.value ~ FD + loc + FD:loc +
+ (1|year) + (1|cut)  + (1|year:cut)
+ (1|FD:year) + (1|loc:year)
+ (1|FD:cut) + (1|loc:cut)
+ (1|FD:loc:year) + (1|FD:loc:cut) + (1|loc:year:cut)
+ (1|FD:loc:year:cut), data = data1)
anova(mod3)
summary(mod1)
summary(mod3)
summary(mod6)
mod6 <- lm(predicted.value ~ FD + gen + loc + FD:loc + gen:loc + year + cut, data = data1)
anova(mod6)
summary(mod6)
mod3 <- lmer(predicted.value ~ FD + loc + FD:loc +
+ (1|year) + (1|cut)  + (1|year:cut)
+ (1|FD:year) + (1|loc:year)
+ (1|FD:cut) + (1|loc:cut)
+ (1|FD:loc:year) + (1|FD:loc:cut) + (1|loc:year:cut)
+ (1|FD:loc:year:cut), data = data1)
mod3
summary(mod3)
mod3
mod6 <- lm(predicted.value ~ FD + loc + year + cut
+ FD:loc + FD:year + FD:cut
+ FD:loc:year + FD:loc:cut + FD:year:cut
+ FD:loc:year:cut, data = data1)
anova(mod6)
anova(mod6)
anova(mod1,mod2,mod3)
anova(mod1,mod2,mod3,mod6)
load("/Users/cesarmedina/Documents/git/Dreger_2022/tidy_Dreger1.RData")
library(metan)
library(data.table)
library(lme4) # GLMM
library(lmerTest) # ANOVA Table (replace it)
## load lmerTest package
library(lmerTest)
## Fit linear mixed model to the ham data:
fm <- lmer(Informed.liking ~ Gender + Information * Product + (1 | Consumer) + (1 | Consumer:Product), data=ham)
summary(fm)
(aov <- anova(fm))
show_tests(aov, fractions = TRUE)$Product
if(requireNamespace("pbkrtest", quietly = TRUE))
anova(fm, type=2, ddf="Kenward-Roger")
ranova(fm)
drop1(fm)
(lsm <- ls_means(fm))
ls_means(fm, which = "Product", pairwise = TRUE)
plot(lsm, which=c("Product", "Information"))
as.data.frame(lsm)
show_tests(lsm, fractions=TRUE)$Product
?anova
?anova
?anova.lmerModLmerTest
anova(fm, ddf="lme4")
anova(mod3)
anova(mod3, ddf="Kenward-Roger")
anova(mod3, ddf="Satterthwaite")
anova(mod3, ddf="lme4")
P1 <- c(30, 50, 50)
P2 <- c(20, 30, 60)
P3 <- c(10, 40, 70)
as.data.frame(P1, P2, P3)
data.frame(P1, P2, P3)
<- data.frame(P1, P2, P3)
DF <- data.frame(P1, P2, P3)
View(DF)
mean(DF)
str(DF)
sum(P1)
mean(P1)
lmerTest::ranova(mod3)
anova(mod3, ddf="lme4")
mod1 <- lmer(predicted.value ~ gen * loc *year + (1|cut) + (1|loc:year:cut), data = data1) ## Incorrect
lmerTest::ranova(mod1)
mod3 <- lmer(predicted.value ~ FD + loc + FD:loc +
+ (1|year) + (1|cut)  + (1|year:cut)
+ (1|FD:year) + (1|loc:year)
+ (1|FD:cut) + (1|loc:cut)
+ (1|FD:loc:year) + (1|FD:loc:cut) + (1|loc:year:cut)
+ (1|FD:loc:year:cut), data = data1)
anova(mod3, ddf="Satterthwaite")
anova(mod3, ddf="Kenward-Roger")
anova(mod3, ddf="lme4")
lmerTest::ranova(mod3)
anova(mod3)
mod2 <- lmer(predicted.value ~ FD + gen + loc + FD:loc + gen:loc + (year) + (1|cut)  + (1|year:cut) + (1|loc:year) + (1|FD:cut) + (1|gen:cut) + (1|FD:loc:year:cut), data = data1)
anova(mod2)
mod2 <- lmer(predicted.value ~ FD + gen + loc + FD:loc + gen:loc + (1|year) + (1|cut)  + (1|year:cut) + (1|loc:year) + (1|FD:cut) + (1|gen:cut) + (1|FD:loc:year:cut), data = data1)
mod2 <- lmer(predicted.value ~ FD + loc + FD:loc + (1|year) + (1|cut)  + (1|year:cut) + (1|loc:year) + (1|FD:cut) + (1|gen:cut) + (1|FD:loc:year:cut), data = data1)
mod2 <- lmer(predicted.value ~ FD + loc + FD:loc + (1|year) + (1|cut)  + (1|year:cut) + (1|loc:year) + (1|FD:cut) + (1|FD:loc:year:cut), data = data1)
lmerTest::ranova(mod2)
anova(mod3)
lmerTest::ranova(mod3)
ranova(mod2, reduce.terms = FALSE)
ranova(mod2, reduce.terms = T)
ranova(mod3, reduce.terms = T)
mod2 <- lmer(predicted.value ~ FD * loc * (1|year) * (1|cut), data = data1)
anova(mod2)
lmerTest::ranova(mod2)
mod2 <- lmer(predicted.value ~ FD * loc + (1|year) + (1|cut) + (1|loc:year:cut), data = data1)
anova(mod2)
mod2 <- lmer(predicted.value ~ FD * loc + (1|year) + (1|cut) + (1|loc:year:cut), REML=FALSE, data = data1)
anova(mod2)
lmerTest::ranova(mod2)
mod6 <- lm(predicted.value ~ FD + loc + year + cut
+ FD:loc + FD:year + FD:cut
+ FD:loc:year + FD:loc:cut + FD:year:cut
+ FD:loc:year:cut, data = data1)
anova(mod6)
summary(mod6)
summary(mod3)
ranova(mod1)[,c(1,3,6)]
anova(mod1)[,c(1,3,6)]
ranova(mod1)
mod1 <- lmer(predicted.value ~ FD * loc * (1|year) + (1|cut) + (1|loc:year:cut), data = data1) ##
anova(mod1)
ranova(mod1)
rand(mod1)
summary(mod3)
anova(mod3, ddf="Kenward-Roger")
lmerTest::ranova(mod3, reduce.terms = T)
anova(mod6)
anova(mod3)[,c(1,3,6)]
ranova(mod3)[,c(1,3,6)]
ls_means(mod3)
ls_means(mod3, pairwise = T)
ls_means(mod3)
show_tests(ls_means(mod3))
ls_means(mod3)
ls_means(mod3, pairwise = T)
anova(mod3)
ranova(mod3, reduce.terms = T)
ls_means(mod3)
ls_means(mod3, pairwise = T)
show_tests(ls_means(mod3))
4 <- update(mod
mod4 <- update(mod3, REML=FALSE, verbose = 1)
mod4 <- update(mod3, REML=FALSE, verbose = 1)
anova(mod4)
ranova(mod4, reduce.terms = T)
lsmeans(mod3, test.effs = NULL, ddf="Satterthwaite")
?lsmeans
?ls_means
ls_means(mod3, which = NULL, ddf="Satterthwaite")
difflsmeans(mod3, which = NULL, ddf="Satterthwaite")
lsmeansLT(mod3, which = NULL, ddf="Satterthwaite")
summary(mod3)
mod5 <- lmer(predicted.value ~ FD + loc + FD:loc +
+ (1|year) + (1|cut) + (year|cut)
+ (FD|year) + (loc|year), data = data1)
anova(mod5)
ranova(mod5, reduce.terms = T)
mod3 <- lmer(predicted.value ~ FD + loc + FD:loc +
+ (1|year) + (1|cut) + (1|year:cut)
+ (1|FD:year) + (1|loc:year)
+ (1|FD:cut) + (1|loc:cut)
+ (1|FD:loc:year) + (1|FD:loc:cut) + (1|loc:year:cut)
+ (1|FD:loc:year:cut), data = data1)
mod4 <- update(mod3, REML=FALSE, verbose = 1)
anova(mod3, mod4)
mod3 <- lmer(predicted.value ~ FD + loc + FD:loc
+ (1|year) + (1|cut) + (1|year:cut)
+ (1|FD:year) + (1|loc:year)
+ (1|FD:cut) + (1|loc:cut)
+ (1|FD:loc:year) + (1|FD:loc:cut) + (1|loc:year:cut)
+ (1|FD:loc:year:cut), data = data1)
mod5 <- lmer(predicted.value ~ FD + loc + FD:loc
+ (1|year) + (1|cut) + (1|year:cut)
+ (1|FD:year) + (1|loc:year)
+ (1|FD:cut) + (1|loc:cut)
+ (1|FD:loc:year) + (1|FD:loc:cut) + (1|loc:year:cut)
, data = data1)
anova(mod3, mod5)
mod5 <- lmer(predicted.value ~ FD + loc + FD:loc
+ (1|FD:year) + (1|loc:year)
+ (1|FD:cut) + (1|loc:cut)
+ (1|FD:loc:year) + (1|FD:loc:cut) + (1|loc:year:cut)
+ (1|FD:loc:year:cut), data = data1)
anova(mod3, mod5)
mod5 <- lmer(predicted.value ~ FD + loc + FD:loc
+ (1|year) + (1|cut) + (1 + year|cut)
+ (1 + FD|year) + (1 + loc|year)
+ (1|FD:loc:year:cut), data = data1)
anova(mod5)
ranova(mod5, reduce.terms = T)
coef(mod5)
str(data1)
summary(mod3)
?lme4::pvalues
library(car)
car::Anova(mod3)
install.packages("RLRsim")
library(RLRsim)
exactRLRT(mod3)
exactLRT(mod3)
lmerTest::anova(mod3)
lmerTest::anova(mod3)
?anova
library(lmerTest) # ANOVA Table (replace it)
?anova
lmerTest::anova(mod3)
?lmerTest::anova
?anova.lmerModLmerTest
anova.lmerModLmerTest(mod3)
anova(mod3, ddf = "lme4")
?car::Anova
car::Anova(mod3)
anova(mod3, ddf = "lme4")
anova.lmerModLmerTest(mod3)
lsmeansLT(mod3, which = NULL, ddf="Satterthwaite")
?lsmeans
?lsmeansLT
View(data1)
ls_means(mod3, pairwise = T)
ls_means(mod3, which = NULL, ddf="Satterthwaite")
difflsmeans(mod3, which = NULL, ddf="Satterthwaite")
ls_means(mod3, which = NULL, ddf="Kenward-Roger")
difflsmeans(mod3, which = NULL, ddf="Satterthwaite")
ls1 <- difflsmeans(mod3, which = NULL, ddf="Satterthwaite")
View(ls1)
?difflsmeans
library(emmeans)
str(data1)
emmeans(mod3, list(pairwise ~ FD), adjust = "tukey")
emmeans(mod3)
?emmeans
?difflsmeans
emmeans(mod3, "nitro")
emmeans(mod3, "FD")
FD_a <- emmeans(mod3, "FD")
contrast(FD_a, "1")
FD_a <- emmeans(mod3, "FD")
contrast(FD_a, "1")
contrast(FD_a, "FD1")
contrast(FD_a)
emmeans(mod3, pairwise ~ FD)
emmeans(mod3, pairwise ~ FD + loc)
show_tests(ls_means(mod3))
ls1 <- difflsmeans(mod3, which = NULL, ddf="Satterthwaite")
###############
# lme model
head(FD4[[1]])
View(FD4)
str(data1)
drop1(mod3)
?drop1
mod5 <- lmer(predicted.value ~ FD + loc
+ (1|year) + (1|cut) + (1|year:cut)
+ (1|FD:year) + (1|loc:year)
+ (1|FD:cut) + (1|loc:cut)
+ (1|FD:loc:year) + (1|FD:loc:cut) + (1|loc:year:cut)
+ (1|FD:loc:year:cut), data = data1)
drop1(mod3)
drop1(mod5)
mod5 <- lmer(predicted.value ~ FD * loc
+ (1|year) + (1|cut) + (1|year:cut)
+ (1|FD:year) + (1|loc:year)
+ (1|FD:cut) + (1|loc:cut)
+ (1|FD:loc:year) + (1|FD:loc:cut) + (1|loc:year:cut)
+ (1|FD:loc:year:cut), data = data1)
drop1(mod5)
drop1(mod5, test = "F")
add1(mod5, test = "F")
(step_res <- step(mod3))
final <- get_model(step_res)
final
anova(final)
summary(mod3, ddf="lme4")
coef(summary(mod3))
lsm <- ls_means(mod3)
plot(lsm, which=c("FD", "loc"))
show_tests(ls_means(mod3))
ranova(mod5, reduce.terms = T)
summary(mod3, ddf="lme4")
summary(mod3)
?glmer
mod5 <- glmer(predicted.value ~ FD * loc
+ (1|year) + (1|cut) + (1|year:cut)
+ (1|FD:year) + (1|loc:year)
+ (1|FD:cut) + (1|loc:cut)
+ (1|FD:loc:year) + (1|FD:loc:cut) + (1|loc:year:cut)
+ (1|FD:loc:year:cut), data = data1)
anova(mod5)
mod5 <- glmer(predicted.value ~ FD * loc
+ (1|year) + (1|cut) + (1|year:cut)
+ (1|FD:year) + (1|loc:year)
+ (1|FD:cut) + (1|loc:cut)
+ (1|FD:loc:year) + (1|FD:loc:cut) + (1|loc:year:cut)
+ (1|FD:loc:year:cut), data = data1, family = binomial)
mod5 <- glmer(predicted.value ~ FD * loc
+ (1|year) + (1|cut) + (1|year:cut)
+ (1|FD:year) + (1|loc:year)
+ (1|FD:cut) + (1|loc:cut)
+ (1|FD:loc:year) + (1|FD:loc:cut) + (1|loc:year:cut)
+ (1|FD:loc:year:cut), data = data1, family = binomial, nAGQ = 0)
## generalized linear mixed model
library(lattice)
xyplot(incidence/size ~ period|herd, cbpp, type=c('g','p','l'),
layout=c(3,5), index.cond = function(x,y)max(y))
(gm1 <- glmer(cbind(incidence, size - incidence) ~ period + (1 | herd),
data = cbpp, family = binomial))
anova(gm1)
fixef(mod3)
ranef(mod3)
ls_means(mod3)
ls_means(mod3, pairwise = T)
ls1 <- difflsmeans(mod3, which = NULL, ddf="Satterthwaite")
View(ls1)
write.csv(ls1, "~/Documents/git/Dreger_2022/stats_1/ls1.csv", quote = F, row.names = T)
write.csv(ls1, "~/Documents/git/Dreger_2022/statistical_results/ls1.csv", quote = F, row.names = T)
sqrt(57.5088)
sqrt(303.151)
303.15 + 2*(57.5088)
303.15 - 2*(57.5088)
sessionInfo()
?glmer
mod4 <- lmer(predicted.value ~ FD * loc
+ (1|year) + (1|cut) + (1|year/cut)
+ (1|FD/year) + (1|loc/year)
+ (1|FD/cut) + (1|loc/cut)
, data = data1)
mod5 <- glmer(predicted.value ~ FD * loc
+ (1|year) + (1|cut) + (1|year/cut)
+ (1|FD/year) + (1|loc/year)
+ (1|FD/cut) + (1|loc/cut)
, data = data1)
summary(mod4)
summary(mod5)
mod3 <- lmer(predicted.value ~ FD + loc + FD:loc
+ (1|year) + (1|cut) + (1|year:cut)
+ (1|FD:year) + (1|loc:year)
+ (1|FD:cut) + (1|loc:cut)
+ (1|FD:loc:year) + (1|FD:loc:cut) + (1|loc:year:cut)
+ (1|FD:loc:year:cut), data = data1)
summary(mod3)
mod6 <- lm(predicted.value ~ FD + loc + year + cut
+ FD:loc + FD:year + FD:cut
+ FD:loc:year + FD:loc:cut + FD:year:cut
+ FD:loc:year:cut, data = data1)
anova(mod6)
anova(mod4)
mod5 <- glmer(predicted.value ~ FD * loc * cut
+ (1|year) + (1|cut) + (1|year/cut)
+ (1|FD/year) + (1|loc/year)
+ (1|FD/cut) + (1|loc/cut)
, data = data1)
mod4 <- lmer(predicted.value ~ FD * loc * cut
+ (1|year) + (1|cut) + (1|year/cut)
+ (1|FD/year) + (1|loc/year)
+ (1|FD/cut) + (1|loc/cut)
, data = data1)
anova(mod4)
mod4 <- lmer(predicted.value ~ FD * loc * year + cut
+ (1|year) + (1|cut) + (1|year/cut)
+ (1|FD/year) + (1|loc/year)
+ (1|FD/cut) + (1|loc/cut)
, data = data1)
anova(mod4)
mod4 <- lmer(predicted.value ~ FD * loc * year * cut
, data = data1)
mod4 <- lmer(predicted.value ~ FD * loc * year * (1|cut)
, data = data1)
mod4 <- lmer(predicted.value ~ FD * loc * year * (1|cut)
, data = data1)
anova(mod4)
mod4 <- lmer(predicted.value ~ FD * loc * year *cut * (1|cut)
, data = data1)
anova(mod4)
ls_means(mod4, pairwise = T)
