library(asremlPlus)
library(data.table)
library(xlsx)
library(reshape2)
require(sqldf)
ST1 <- list()
ST3 <- list()
ST4 <- list()
data <- droplevels(ST02[[21]]) # TTNDFD
data1 <- na.omit(data)
M1 <- asreml::asreml(fixed = predicted.value ~ FD * loc ,
random = ~ us(loc):ar1(env4):id(gen),
data = data1, na.action = list(x = "include", y = "include"),
weights = weight, family = asreml::asr_gaussian(dispersion = 1))
W1 <- wald.asreml(M1)
W2 <- summary(M1)$varcomp
View(W1)
View(W2)
current.asrt <- as.asrtests(M1, NULL, NULL)
current.asrt <- rmboundary.asrtests(current.asrt)
ST2 <- list()
ST2 <- list()
for (j in 1:length(lev6)) {
diffs <- predictPlus(classify = lev6[j],
asreml.obj = M1,
wald.tab = current.asrt$wald.tab,
present = c("FD","gen","loc","env4"))
ST2[[length(ST2)+1]] <- diffs
}
M1 <- asreml::asreml(fixed = predicted.value ~ FD * loc ,
random = ~ us(loc):ar1(env4):id(gen) + year,
data = data1, na.action = list(x = "include", y = "include"),
weights = weight, family = asreml::asr_gaussian(dispersion = 1))
W1 <- wald.asreml(M1)
ST3[[length(ST3)+1]] <- W1
W2 <- summary(M1)$varcomp
current.asrt <- as.asrtests(M1, NULL, NULL)
current.asrt <- rmboundary.asrtests(current.asrt)
ST2 <- list()
for (j in 1:length(lev6)) {
diffs <- predictPlus(classify = lev6[j],
asreml.obj = M1,
wald.tab = current.asrt$wald.tab,
present = c("FD","gen","loc","env4"))
ST2[[length(ST2)+1]] <- diffs
}
ST1 <- list()
ST3 <- list()
ST4 <- list()
for (i in 1:(length(ST03))) {
data <- ST03[[i]]
data1 <- na.omit(data)
head(data1)
# M1 <- asreml::asreml(fixed = predicted.value ~ FD * loc ,
#                      random = ~ us(loc):ar1(env3):id(gen) + year,
#                      data = data1, na.action = list(x = "include", y = "include"),
#                      weights = weight, family = asreml::asr_gaussian(dispersion = 1))
M1 <- asreml::asreml(fixed = predicted.value ~ FD * loc ,
random = ~ us(loc):ar1(env4):id(gen) + year,
data = data1, na.action = list(x = "include", y = "include"),
weights = weight, family = asreml::asr_gaussian(dispersion = 1))
W1 <- wald.asreml(M1)
ST3[[length(ST3)+1]] <- W1
W2 <- summary(M1)$varcomp
ST4[[length(ST4)+1]] <- W2
current.asrt <- as.asrtests(M1, NULL, NULL)
current.asrt <- rmboundary.asrtests(current.asrt)
ST2 <- list()
for (j in 1:length(lev6)) {
diffs <- predictPlus(classify = lev6[j],
asreml.obj = M1,
wald.tab = current.asrt$wald.tab,
present = c("FD","gen","loc","env4"))
ST2[[length(ST2)+1]] <- diffs
}
names(ST2) <- lev5
ST1[[length(ST1)+1]] <- ST2
}
length(ST1)
length(ST03)
names(ST1) <- names(ST03)
names(ST3) <- names(ST03)
names(ST4) <- names(ST03)
names(ST1[[13]])
df1 <- as.data.frame(ST1[[13]][[11]][[1]])
head(df1)
ggplot(df1, aes(x=year, y=predicted.value, group=FD, color=FD)) +
geom_line(linetype="twodash") +
geom_point(aes(color = FD), size = 1, alpha = 0.6) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, alpha = 0.6) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2)) + facet_grid(. ~ loc, scales = "free_x", space = "free") +
scale_color_brewer(palette = "Dark2")
ggplot(df1, aes(x=FD, y=predicted.value)) +
geom_point(size = 1) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, alpha = 0.6) +
theme_classic(base_family = "Arial", base_size = 12) +
facet_grid(. ~ loc, scales = "free_x", space = "free") +
facet_grid(loc ~ year, scales = "free_x", space = "free")
df1 <- as.data.frame(ST1[[13]][[5]][[1]])
head(df1)
ggplot(df1, aes(x=FD, y=predicted.value)) +
geom_point(size = 1) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, alpha = 0.6) +
theme_classic(base_family = "Arial", base_size = 12) +
facet_grid(. ~ loc, scales = "free_x", space = "free")
ggplot(df1, aes(x=FD, y=predicted.value)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.5)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, alpha = 0.6) +
theme_classic(base_family = "Arial", base_size = 12) +
facet_grid(. ~ loc, scales = "free_x", space = "free") +
facet_grid(loc ~ year, scales = "free_x", space = "free")
ggplot(df1, aes(x=FD, y=predicted.value)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.5)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, alpha = 0.6) +
theme_classic(base_family = "Arial", base_size = 12)
# b
ggplot(df1, aes(x=FD, y=predicted.value)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.5)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.5))
# b
ggplot(df1, aes(x=FD, y=predicted.value)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.5)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.5)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, alpha = 0.6) +
theme_classic(base_family = "Arial", base_size = 12)
df1 <- as.data.frame(ST1[[13]][[11]][[1]])
head(df1)
ggplot(df1, aes(x=FD, y=predicted.value, group=loc)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.5)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.5)) +
theme_classic(base_family = "Arial", base_size = 12) +
facet_grid(. ~ env4, scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.5)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.5)) +
theme_classic(base_family = "Arial", base_size = 12) +
facet_grid(. ~ FD, scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.8)) +
theme_classic(base_family = "Arial", base_size = 12) +
facet_grid(. ~ FD, scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.8)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2)) +
facet_grid(. ~ FD, scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.8)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2)) +
facet_grid(loc ~ FD, scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.8)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2)) +
facet_grid(FD ~ ., scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.8)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2)) +
facet_grid(. ~ FD., scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.8)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2)) +
facet_grid(. ~ FD, scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(0, 1, 5)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.8)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2)) +
facet_grid(. ~ FD, scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(0, 1, 18)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.8)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2)) +
facet_grid(. ~ FD, scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.8), shape=loc, color=loc) +
scale_shape_manual(values = c(0, 1, 5)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.8)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2)) +
facet_grid(. ~ FD, scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(0, 1, 5)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.8)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2)) +
facet_grid(. ~ FD, scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(22, 21, 23)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.8)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2)) +
facet_grid(. ~ FD, scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.8)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2)) +
facet_grid(. ~ FD, scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2)) +
facet_grid(. ~ FD, scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(22, 21, 23)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2)) +
facet_grid(. ~ FD, scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2)) +
facet_grid(. ~ FD, scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.08, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2)) +
facet_grid(. ~ FD, scales = "free_x", space = "free")
df1 <- as.data.frame(ST1[[13]][[11]][[1]])
head(df1)
ggplot(df1, aes(x=FD, y=predicted.value)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.5)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, alpha = 0.6) +
theme_classic(base_family = "Arial", base_size = 12)
ggplot(df1, aes(x=FD, y=predicted.value)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.5)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.5)) +
theme_classic(base_family = "Arial", base_size = 12)
df1 <- as.data.frame(ST1[[13]][[11]][[1]])
head(df1)
# b
ggplot(df1, aes(x=FD, y=predicted.value, group=loc)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.5)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.5)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, alpha = 0.6) +
theme_classic(base_family = "Arial", base_size = 12)
df1 <- as.data.frame(ST1[[13]][[5]][[1]])
head(df1)
View(df1)
df1 <- as.data.frame(ST1[[13]][[1]][[1]])
head(df1)
ggplot(df1, aes(x=FD, y=predicted.value)) +
geom_point(size = 1) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, alpha = 0.6) + theme_classic(base_family = "Arial", base_size = 12)
df1 <- as.data.frame(ST1[[13]][[2]][[1]])
head(df1)
ggplot(df1, aes(x=loc, y=predicted.value)) +
geom_point(size = 1) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, alpha = 0.6) +
theme_classic(base_family = "Arial", base_size = 12)
df1 <- as.data.frame(ST1[[13]][[5]][[1]])
head(df1)
names((ST1[[13]]))
# b
ggplot(df1, aes(x=FD, y=predicted.value, group=loc)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.5)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.5)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, alpha = 0.6) +
theme_classic(base_family = "Arial", base_size = 12)
# b
ggplot(df1, aes(x=FD, y=predicted.value)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.5)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.5)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, alpha = 0.6) +
theme_classic(base_family = "Arial", base_size = 12)
# b
ggplot(df1, aes(x=FD, y=predicted.value, group = loc)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.5)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.5)) +
theme_classic(base_family = "Arial", base_size = 12)
# C
ggplot(df1, aes(x=FD, y=predicted.value, group = loc)) +
geom_point(size = 1, aes(shape=loc), na.rm=TRUE, position=position_dodge(width=0.5)) +
scale_shape_manual(values = c(2, 0, 1)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, na.rm=TRUE, position=position_dodge(width=0.5)) +
theme_classic(base_family = "Arial", base_size = 12)
# C
ggplot(df1, aes(x=FD, y=predicted.value, group = loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.08, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme_classic(base_family = "Arial", base_size = 12)
df1 <- as.data.frame(ST1[[13]][[11]][[1]])
head(df1)
df1 <- as.data.frame(ST1[[13]][[11]][[1]])
head(df1)
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.08, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2)) +
facet_grid(. ~ FD, scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.08, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2), legend.position="none") +
facet_grid(. ~ FD, scales = "free_x", space = "free")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.08, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2), legend.position="none") +
facet_grid(. ~ FD, scales = "free_x", space = "free") + labs(y = "", x = "")
# FD_loc
# C
df1 <- as.data.frame(ST1[[13]][[5]][[1]])
head(df1)
ggplot(df1, aes(x=FD, y=predicted.value, group = loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.08, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme_classic(base_family = "Arial", base_size = 12) + labs(y = "", x = "")
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.08, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2), legend.position="none") +
facet_grid(. ~ FD, scales = "free_x", space = "free") + labs(y = "", x = "Harvest")
df1 <- as.data.frame(ST1[[13]][[11]][[1]])
head(df1)
ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.08, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2), legend.position="none") +
facet_grid(. ~ FD, scales = "free_x", space = "free") + labs(y = "", x = "Harvest")
# FD_loc
# C
df1 <- as.data.frame(ST1[[13]][[5]][[1]])
head(df1)
ggplot(df1, aes(x=FD, y=predicted.value, group = loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.08, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme_classic(base_family = "Arial", base_size = 12)
# C
C <- ggplot(df1, aes(x=FD, y=predicted.value, group = loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.08, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme(legend.position="none") +
theme_classic(base_family = "Arial", base_size = 12) + labs(y = "", x = "FD")
ggplot(df1, aes(x=FD, y=predicted.value, group = loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.08, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme(legend.position="none") +
theme_classic(base_family = "Arial", base_size = 12) + labs(y = "", x = "FD")
ggplot(df1, aes(x=FD, y=predicted.value, group = loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.08, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(legend.position="none") + labs(y = "", x = "FD")
save.image("~/Documents/git/Dreger_2022/tidy_Dreger1.RData")
load("/home/hawkins/Documents/git/Dreger_2022/tidy_Dreger1.RData")
library(tidyverse)
library(ggcorrplot)
library(patchwork)
library(Matrix)
library(asreml)
library(asremlPlus)
library(data.table)
library(xlsx)
library(reshape2)
require(sqldf)
names(ST4)
names(ST1[[13]])
library(patchwork)
df1 <- as.data.frame(ST1[[13]][[1]][[1]])
head(df1)
# A
A <- ggplot(df1, aes(x=FD, y=predicted.value)) +
geom_point(size = 1) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, alpha = 0.6) + theme_classic(base_family = "Arial", base_size = 12)
# B
df1 <- as.data.frame(ST1[[13]][[2]][[1]])
head(df1)
B <- ggplot(df1, aes(x=loc, y=predicted.value)) +
geom_point(size = 1) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, alpha = 0.6) +
theme_classic(base_family = "Arial", base_size = 12)
# FD_loc
# C
df1 <- as.data.frame(ST1[[13]][[5]][[1]])
head(df1)
# C
C <- ggplot(df1, aes(x=FD, y=predicted.value, group = loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.08, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(legend.position="none") + labs(y = "", x = "FD")
df1 <- as.data.frame(ST1[[13]][[11]][[1]])
head(df1)
D <- ggplot(df1, aes(x=env4, y=predicted.value, group=loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.08, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.95, vjust = 0.2), legend.position="none") +
facet_grid(. ~ FD, scales = "free_x", space = "free") + labs(y = "", x = "Harvest")
A + B + plot_layout(ncol = 2)
df1 <- as.data.frame(ST1[[13]][[1]][[1]])
head(df1)
# A
A <- ggplot(df1, aes(x=FD, y=predicted.value)) +
geom_point(size = 1) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, alpha = 0.6) + theme_classic(base_family = "Arial", base_size = 12) + labs(y = "", x = "FD")
# B
df1 <- as.data.frame(ST1[[13]][[2]][[1]])
head(df1)
B <- ggplot(df1, aes(x=loc, y=predicted.value)) +
geom_point(size = 1) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.1, alpha = 0.6) +
theme_classic(base_family = "Arial", base_size = 12) + labs(y = "", x = "Loc")
A + B + C + D + plot_layout(ncol = 2)
library(ggpubr)
ggarrange(A, B, heights = c(2, 0.7), ncol = 1, nrow = 2, align = "v")
ggarrange(D, ggarrange(A, C, ncol = 2), nrow = 2)
ggarrange(A, B, widths = c(2, 07), ncol = 2, nrow = 1, align = "h")
ggarrange(A, B, widths = c(2, 0.7), ncol = 2, nrow = 1, align = "h")
ggarrange(A, B, widths = c(1, 0.5), ncol = 2, nrow = 1, align = "h")
ggarrange(ggarrange(A, B, widths = c(1, 0.5), ncol = 2, nrow = 1, align = "h"), C, ncol = 2, nrow = 1, align = "h")
ggarrange(ggarrange(A, B, widths = c(1, 0.5), ncol = 2, nrow = 1), C, ncol = 2, nrow = 1, align = "h")
ggarrange(ggarrange(A, B, widths = c(1, 0.5), ncol = 2, nrow = 1), C, ncol = 2, nrow = 1)
# C
C <- ggplot(df1, aes(x=FD, y=predicted.value, group = loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.08, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(legend.position="none") + labs(y = "", x = "FD by Loc")
ggarrange(ggarrange(A, B, widths = c(1, 0.5), ncol = 2, nrow = 1), C, ncol = 2, nrow = 1)
ggarrange(ggarrange(A, B, widths = c(1, 0.5), ncol = 2, nrow = 1), C, ncol = 2, nrow = 1)
C <- ggplot(df1, aes(x=FD, y=predicted.value, group = loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.08, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(legend.position="none") + labs(y = "", x = "FD by Loc")
# FD_loc
# C
df1 <- as.data.frame(ST1[[13]][[5]][[1]])
head(df1)
# C
C <- ggplot(df1, aes(x=FD, y=predicted.value, group = loc)) +
geom_errorbar(aes(ymin = lower.Confidence.limit, ymax = upper.Confidence.limit), width = 0.08, na.rm=TRUE, position=position_dodge(width=0.8)) +
geom_point(size = 1, aes(shape=loc, color = loc), na.rm=TRUE, position=position_dodge(width=0.8)) +
scale_shape_manual(values = c(15, 16, 18)) +
theme_classic(base_family = "Arial", base_size = 12) +
theme(legend.position="none") + labs(y = "", x = "FD by Loc")
C
ggarrange(ggarrange(A, B, widths = c(1, 0.5), ncol = 2, nrow = 1), C, ncol = 2, nrow = 1)
ggarrange(ggarrange(ggarrange(A, B, widths = c(1, 0.5), ncol = 2, nrow = 1), C, ncol = 2, nrow = 1), D, ncol = 1, nrow = 2)
ggarrange(ggarrange(ggarrange(A, B, widths = c(1, 0.5), ncol = 2, nrow = 1, labels = c("A", "B")), C, ncol = 2, nrow = 1, labels = "C"), D, ncol = 1, nrow = 2, labels = "D")
ggarrange(ggarrange(A, B, widths = c(1, 0.5), ncol = 2, nrow = 1, labels = c("A", "B")), C, ncol = 2, nrow = 1, labels = "C")
ggarrange(ggarrange(ggarrange(A, B, widths = c(1, 0.5), ncol = 2), C, ncol = 2, nrow = 1), D, ncol = 1, nrow = 2)
ggarrange(ggarrange(ggarrange(A, B, widths = c(1, 0.5), ncol = 2), C, ncol = 2, nrow = 1), D, ncol = 1, nrow = 2, heights = c(0.7, 1))
ggarrange(ggarrange(ggarrange(A, B, widths = c(1, 0.5), ncol = 2), C, ncol = 2, nrow = 1), D, ncol = 1, nrow = 2, heights = c(0.7, 1), align = "v")
E <- ggarrange(ggarrange(ggarrange(A, B, widths = c(1, 0.5), ncol = 2), C, ncol = 2, nrow = 1), D, ncol = 1, nrow = 2, heights = c(0.7, 1), align = "v")
setwd("~/Documents/git/Dreger_2022/figs/")
names(ST1)
ggsave(filename = "Lignin.jpg", plot = E, width = 15, height = 9)
ggsave(filename = "Lignin.jpg", plot = E, width = 15, height = 6)
